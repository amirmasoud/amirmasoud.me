<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Create VSCode extension from scratch to testing, documentation, and publishing | Amirmasoud</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Introduction
In this post, We would try to develop and publish a visual studio code extension using VSCode samples, APIs, and TypeScript. The extension we will make is called Oops and is currently available at the VSCode Marketplace and GitHub if you want to check it out for yourself.
This extension will be a simple and straightforward one as the functionalities are limited to these four items:">
    <meta name="generator" content="Hugo 0.140.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Amirmasoud">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/2020/10/16/create-vscode-extension-from-scratch-to-testing-documentation-and-publishing/">
    

    <meta property="og:url" content="http://localhost:1313/2020/10/16/create-vscode-extension-from-scratch-to-testing-documentation-and-publishing/">
  <meta property="og:site_name" content="Amirmasoud">
  <meta property="og:title" content="Create VSCode extension from scratch to testing, documentation, and publishing">
  <meta property="og:description" content="Introduction In this post, We would try to develop and publish a visual studio code extension using VSCode samples, APIs, and TypeScript. The extension we will make is called Oops and is currently available at the VSCode Marketplace and GitHub if you want to check it out for yourself.
This extension will be a simple and straightforward one as the functionalities are limited to these four items:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-10-16T11:47:36+00:00">
    <meta property="article:modified_time" content="2020-10-16T11:47:36+00:00">
    <meta property="article:tag" content="Extension">
    <meta property="article:tag" content="Vscode">

  <meta itemprop="name" content="Create VSCode extension from scratch to testing, documentation, and publishing">
  <meta itemprop="description" content="Introduction In this post, We would try to develop and publish a visual studio code extension using VSCode samples, APIs, and TypeScript. The extension we will make is called Oops and is currently available at the VSCode Marketplace and GitHub if you want to check it out for yourself.
This extension will be a simple and straightforward one as the functionalities are limited to these four items:">
  <meta itemprop="datePublished" content="2020-10-16T11:47:36+00:00">
  <meta itemprop="dateModified" content="2020-10-16T11:47:36+00:00">
  <meta itemprop="wordCount" content="2049">
  <meta itemprop="keywords" content="Extension,Vscode">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Create VSCode extension from scratch to testing, documentation, and publishing">
  <meta name="twitter:description" content="Introduction In this post, We would try to develop and publish a visual studio code extension using VSCode samples, APIs, and TypeScript. The extension we will make is called Oops and is currently available at the VSCode Marketplace and GitHub if you want to check it out for yourself.
This extension will be a simple and straightforward one as the functionalities are limited to these four items:">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  
  
  
  <header class="cover bg-center" style="background-image: url('http://localhost:1313/wp-content/uploads/2020/09/vscode_wp.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Amirmasoud
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">Create VSCode extension from scratch to testing, documentation, and publishing</div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">Create VSCode extension from scratch to testing, documentation, and publishing</h1>
      
      <p class="tracked">
        By <strong>Amirmasoud</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-10-16T11:47:36Z">October 16, 2020</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 class="wp-block-heading" id="introduction">Introduction</h2>
<p>In this post, We would try to develop and publish a visual studio code extension using VSCode samples, APIs, and TypeScript. The extension we will make is called Oops and is currently available at the <!-- raw HTML omitted -->VSCode Marketplace<!-- raw HTML omitted --> and <!-- raw HTML omitted -->GitHub<!-- raw HTML omitted --> if you want to check it out for yourself.</p>
<p>This extension will be a simple and straightforward one as the functionalities are limited to these four items:</p>
<!-- raw HTML omitted -->
<pre><code>  &lt;li&gt;
    Can convert a directory to a file&lt;ul&gt;
      &lt;li&gt;
        Check if the directory has any children
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>The extension would help those who mistakenly create a file instead of a directory or vise versa and have to delete, make a new one, and potentially type the full name of the file or directory again. With this extension, it is possible to right-click and jump between file type and directory type.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted --> <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 class="wp-block-heading" id="implement">Implement</h2>
<h3 class="wp-block-heading" id="tools">Tools</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 class="wp-block-heading" id="init">Init</h3>
<p>in your preferred destination execute:</p>
<!-- raw HTML omitted -->
<p><em>? What type of extension do you want to create?</em> <strong>New Extension (TypeScript)</strong></p>
<p><em>? What’s the name of your extension?</em> <strong>Oops</strong></p>
<p><em>? What’s the identifier of your extension?</em> <strong>oops</strong></p>
<p><em>? What’s the description of your extension?</em> <strong>BLANK</strong></p>
<p><em>? Initialize a git repository?</em> <strong>Yes</strong></p>
<p><em>? Which package manager to use?</em> <strong>yarn</strong></p>
<h3 class="wp-block-heading" id="procedure">Procedure</h3>
<p>We need two main functionality in this project:</p>
<!-- raw HTML omitted -->
<p>We need two main validations before each operation:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>We need to use VS Code <a href="https://code.visualstudio.com/api/references/vscode-api#FileSystem">FileSystem</a> API extensively. One of the best places to find good examples of use cases for VS Code Extensions in <a href="https://github.com/microsoft/vscode-extension-samples">VS Code Extension Samples</a> repositories. It has a wide variety of different examples and uses different APIs of VS Code. One of those examples is <a href="https://github.com/microsoft/vscode-extension-samples/tree/12a3528bae5fd7f97c9966fba2daede8b8adde31/tree-view-sample">the tree view example</a> which includes one file we can utilize in our extension. It is <a href="https://github.com/microsoft/vscode-extension-samples/blob/12a3528bae5fd7f97c9966fba2daede8b8adde31/tree-view-sample/src/fileExplorer.ts">fileExplorer.ts</a> and covers all necessary FileSystem APIs we need such as delete directory, delete the file, create a new directory and, create a new file. we copy over this file to our <code>src</code> directory. we also need to add <code>@types/rimraf</code> and <code>@types/mkdirp</code> to <code>devDependencies</code>, and <code>mkdirp</code> and <code>rimraf</code> to <code>dependencies</code> in order to enable us to make a new directory and remove a directory.</p>
<h3 class="wp-block-heading" id="contribution">Contribution</h3>
<p>We start with editing our <code>package.json</code> file. We have used an <a href="https://code.visualstudio.com/api/references/extension-manifest">extension manifest</a> for filling this file.</p>
<!-- raw HTML omitted -->
<p>We define an activation event for our extension. Activation event is:</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><a href="https://code.visualstudio.com/api/references/activation-events">https://code.visualstudio.com/api/references/activation-events</a><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>whenever <code>oops.swap</code> been invoked, our extension becomes active. Then we have to fill out <code>contributes</code> section of <code>package.json</code>:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>In the command section, we have defined <code>command</code> and <code>title</code> for our extension and also added its <code>explorer/context</code> menu, these are called <a href="https://code.visualstudio.com/api/references/contribution-points">Contribution Points</a>. Ours is in <code>explorer context menu</code> and is located in the <code>cutcopypaste</code> group of the menu is <a href="https://code.visualstudio.com/api/references/contribution-points#Sorting-of-groups">sorted</a> at the end of the group because of <code>@999</code>. This will give us <code>File ↔ Folder</code> menu item in the context menu:</p>
<!-- raw HTML omitted -->
<p>Next, in <code>src/extension.js</code> we start to write the actual functionality of our extension. First, we implement the functionality of the file to the folder:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>It’s an <code>async</code> function which first reads the given file URI content. We should do this to be sure we would not cause messing with people’s code and only convert those files that are actually empty. the simplest approach is to read the content and then check the length of it like:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>But this approach leaves us by reacting to file with return/enter character as not empty files. This can be a particular case with lots of users who have enabled to enter a return/enter at the end of all files at the save. We don’t want that behavior. So we have to define our own definition of emptiness.</p>
<p>First, we should note that VS Code <code>FS</code> API gives back content of a file character by character in an <code>Array</code> of ASCII code of corresponding characters. We that in mind, we can call a file empty if and only if all characters presented in a file are:<!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  &lt;strong&gt;ASCII Code&lt;/strong&gt;
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  9
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  10
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  13
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  32
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<p>Then we can check if every character in a file is one of the above ASCII codes:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><code>isEmpty</code> is going to be <code>true</code> if every character in the given content are one of four specified characters and would be <code>false</code> if there is any other character in the file.</p>
<p>The very last step for <code>fileToFolder</code> functionality is to do the actual swap between file and folder:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Now that we are done with this functionality we can move to implement <code>folderToFile</code> functionality. The first step is to check if the directory is empty:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>if <code>children.length</code> is not zero, we have a not empty directory and we should abort function, otherwise, we are good to go. Now, we can initial a new file with the same URI of the folder, delete that folder and write a new file:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The only note in the above code is that we are setting content to empty object of type <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array">Uint8Array</a> and we should pass <code>create</code> and <code>overwrite</code> parameters to <code>writeFile</code> method.</p>
<p>Our extension is almost ready and we a full implementation of all functionality we planned to have:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>From the activity center select and execute Run <code>Extension</code> and you should see your extension in a new VS Code window.</p>
<h3 class="wp-block-heading" id="testing">Testing</h3>
<p>As we have implantation for our extension, it is always good to write corresponding testing suite cases for our codes. We start things with editing <code>src/test/suite/extension.test.js</code> file.</p>
<p>In case of testing, we should make sure these four behavior are implemented as expected:</p>
<!-- raw HTML omitted -->
<p>First, we need to include the actual extension file in our test file, we add the following import at the top of our test file:</p>
<!-- raw HTML omitted -->
<p>Next, we need an actual environment to test these functionalities, and by the environment, I mean a bunch of files and folders that we can run tests against them. So we create one:</p>
<!-- raw HTML omitted -->
<p>In this example environment, we have:</p>
<!-- raw HTML omitted -->
<p>We import our test environment into our test file along <code>fs</code> and <code>path</code> libraries:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The first test case is to convert folder to file and we need <code>oops_file.js</code> to be converted to a file. So we need its URI:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Then we need to run <code>folderToFile</code> function on the folder and assert it is converted to a file.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>So far so good, but there is one caveat here, first we need to convert back this process in order to keep running tests without constantly fix our test environment directory. for our extension, it is as easy as calling <code>fileToFolder</code>:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The second caveat for this particular test case is that we want to run these test cases using GitHub actions later on. We want to share this project with other developers, possibly. Still, an empty folder would not be committed into our git repository without having anything in it, and our <code>folderToFile</code> function won’t run when it has any children in it. So what should we do? We can fix by adding a <code>.gitkeep</code> file into this folder, and then in our test case, we move this file to the root of the testing environment directory, and at the end of the test, we move back it into its original place. Like this:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>With that put aside, it’s time to move to the next test case. 2nd test case is ensuring we won’t convert a not empty directory to a file. If we do this, the user will lose information in that folder.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>We get <code>uri</code> of the the <code>not_empty_directory</code> directory and call <code>folderToFile</code> method on it. Now we can assert that the given directory is still a directory and the only file in that folder <code>directory_with_children</code> is still a file.</p>
<p>The next test would be testing to see if we can change the file to a folder. For that, we would run the following test:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The last test is to check if we would not be able to delete a file which is not empty:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>From activity center run <code>Extension Tests</code> and you should all tests passed.</p>
<h4 class="wp-block-heading" id="test-automation">Test Automation</h4>
<p>This step is optional, but we can set <!-- raw HTML omitted -->GitHub Actions<!-- raw HTML omitted --> to run our tests every time we push. create a <code>ci.yml</code> file in <code>.github</code> directory with the following content:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>In this file, we are telling GitHub action to listen to pushes on branch master, and if one happened, executes the defined job. In the job, we basically set up to run <code>yarn run test</code> command, so we need node and we want it to be run on 3 different OSes, macOS, Ubuntu, and Windows.</p>
<h3 class="wp-block-heading" id="documentation">Documentation</h3>
<p>Our extension functionality is a test and ready and surely we can ship it now, but a software without any documentation can be only useful to the author of that software and would not go anywhere besides the author’s projects. Once I have read that you should put the same amount of time into the documentation as the same you invest in coding, so don’t underestimate documentation.</p>
<p>Having a GIF image in your readme for the extension can quickly deliver the main functionalities your extension is providing. If you already don’t have a GIF maker software, you can try <a href="https://apps.apple.com/us/app/giphy-capture-the-gif-maker/id668208984">GIPHY Capture</a> for mac, <a href="https://www.screentogif.com/">ScreenToGif</a> for Windows, or <a href="https://github.com/phw/peek">Peek</a> for Linux. The final GIF can be placed in <code>README.md</code> a file, you can check mine at <a href="https://github.com/amirmasoud/oops/blob/master/README.md">here</a>. The saved gifs can be placed <code>screenshots</code> in folder or similar places.</p>
<p>Next in your <code>README</code> add more details about your extension, answer questions like whats is for? Who is it for? What features it offers? Also, add bug_report and feature_request template in your repository so any possible bug or feature would be in the same template, and it easier to maintain them. Read about the GitHub issue template here, and you should find similar documentation for other VCS platforms such as GitLab and BitBucket.</p>
<p>Final optional touches for documentation would be adding. CHANGELOG, CODE_OF_CONDUCT, and CONTRIBUTING. And also, we should always include a LICENSE file in our repositories. By adding a license file, we enable other potential contributors to use, change, and distribute our code.</p>
<h3 class="wp-block-heading" id="publish">Publish</h3>
<p>With everything in place, it’s time to make our extension ready to be published. We start by adding .gitattributes to our file. In this file, we exclude any file that is not necessary to be included when an end-user uses our code. Those not necessary files can be a large screenshot, tests directory, and any file not required by the extension. You can read more about <code>gitattributes</code> in <!-- raw HTML omitted -->git documentation<!-- raw HTML omitted -->.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The next step in publishing our extension is to add a nice icon for it. I have gone with the following icon, nothing special is going on in my icon design but you can put more time into yours:</p>
<!-- raw HTML omitted -->
<p>save your extension icon in the images directory and head to packages.json adjust it for our extension. in this file we would set extension manifest for our extension, refer to the documentation for further details, and also you can check the <!-- raw HTML omitted -->Oops packages.json file<!-- raw HTML omitted -->.</p>
<p>Our final step will be to create a publisher for Visual Studio Code Extension Market if we don’t have one and login afterward. VS Codde documentation has explained it in detail. We can now publish our extension by executing:</p>
<!-- raw HTML omitted -->
<p>And after a few minutes, we would be live! 🎉<!-- raw HTML omitted --></p>
<p><a href="https://marketplace.visualstudio.com/items?itemName=amirmasoud.oops"><!-- raw HTML omitted --></a><!-- raw HTML omitted --></p>
<h3 class="wp-block-heading" id="conclusion">Conclusion</h3>
<p>We have learned how to create an extension for Visual Studio Code, test it, and deploy it. The only remaining step in any software is to market it and introduce it to other people. You can do so by tweeting about it, especially during creation time, and/or create a blog post and release notes about each version of it. A software without any user is kind of abandon despite how well made it could be, so go out there and tell about what you were working on.</p>
<p>Even though Oops is a tiny extension and is not deep dive into Visual Code extension APIs, there is still room to grow by implementing some other possible features such as disabling option if file or folder could not be deleted or added keyboard shortcut. Of course, it might not be a vital requirement for this particular extension.</p>
<p>Lastly, you can check Visual Studio Code Documentation for learning more about extension development. Also, you can go to <!-- raw HTML omitted -->Oops GitHub repo<!-- raw HTML omitted --> for full implementation and start it if you liked it and let me know if you didn’t. You can reach out to me on Twitter via <!-- raw HTML omitted -->@AmirmasoudShey1<!-- raw HTML omitted -->.</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/extension/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Extension</a>
   </li>
  
   <li class="list di">
     <a href="/tags/vscode/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Vscode</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Amirmasoud 2024 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>

  </body>
</html>
